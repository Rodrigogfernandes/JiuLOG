<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste do Sistema JiuLOG</title>
    <link rel="stylesheet" href="css/theme.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .test-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
        }
        .test-item {
            background: var(--bg-card);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: var(--border-radius-small);
            border-left: 4px solid var(--primary-color);
        }
        .test-item.success {
            border-left-color: #28a745;
        }
        .test-item.error {
            border-left-color: #dc3545;
        }
        .test-item.warning {
            border-left-color: #ffc107;
        }
        .test-status {
            font-weight: bold;
            margin-left: 1rem;
        }
        .test-status.success { color: #28a745; }
        .test-status.error { color: #dc3545; }
        .test-status.warning { color: #ffc107; }
        .test-details {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <!-- Partículas flutuantes -->
    <div class="particles" id="particles"></div>
    
    <div class="container">
        <div class="logo">
            <i class="fas fa-fist-raised"></i>
            JiuLOG
        </div>
        <h2><i class="fas fa-bug"></i> Teste do Sistema</h2>
        
        <div class="test-container">
            <div class="test-item" id="test-1">
                <i class="fas fa-server"></i> Teste de Conexão com Banco de Dados
                <span class="test-status" id="status-1">Testando...</span>
                <div class="test-details" id="details-1">Verificando conexão com MySQL...</div>
            </div>
            
            <div class="test-item" id="test-2">
                <i class="fas fa-database"></i> Teste de Estrutura do Banco
                <span class="test-status" id="status-2">Aguardando...</span>
                <div class="test-details" id="details-2">Verificando tabelas necessárias...</div>
            </div>
            
            <div class="test-item" id="test-3">
                <i class="fas fa-file-code"></i> Teste de Arquivos PHP
                <span class="test-status" id="status-3">Aguardando...</span>
                <div class="test-details" id="details-3">Verificando scripts PHP...</div>
            </div>
            
            <div class="test-item" id="test-4">
                <i class="fas fa-palette"></i> Teste de CSS e JavaScript
                <span class="test-status" id="status-4">Aguardando...</span>
                <div class="test-details" id="details-4">Verificando recursos frontend...</div>
            </div>
            
            <div class="test-item" id="test-5">
                <i class="fas fa-mobile-alt"></i> Teste de Responsividade
                <span class="test-status" id="status-5">Aguardando...</span>
                <div class="test-details" id="details-5">Verificando design responsivo...</div>
            </div>
        </div>
        
        <div class="button-container">
            <button onclick="runAllTests()" class="btn">
                <i class="fas fa-play"></i>
                Executar Todos os Testes
            </button>
            <a href="index.html" class="btn btn-outline">
                <i class="fas fa-arrow-left"></i>
                Voltar ao Sistema
            </a>
        </div>
    </div>

    <script>
        // Criar partículas flutuantes
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 10;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                const size = Math.random() * 3 + 1;
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 5) + 's';
                
                particlesContainer.appendChild(particle);
            }
        }
        
        // Inicializar partículas
        document.addEventListener('DOMContentLoaded', createParticles);
        
        // Função para atualizar status do teste
        function updateTestStatus(testId, status, message, details) {
            const testItem = document.getElementById(`test-${testId}`);
            const statusElement = document.getElementById(`status-${testId}`);
            const detailsElement = document.getElementById(`details-${testId}`);
            
            testItem.className = `test-item ${status}`;
            statusElement.textContent = message;
            statusElement.className = `test-status ${status}`;
            detailsElement.textContent = details;
        }
        
        // Teste 1: Conexão com Banco de Dados
        async function testDatabaseConnection() {
            try {
                const response = await fetch('php/db.php');
                if (response.ok) {
                    updateTestStatus(1, 'success', '✓ Sucesso', 'Conexão com banco de dados estabelecida');
                } else {
                    updateTestStatus(1, 'error', '✗ Erro', 'Falha na conexão com banco de dados');
                }
            } catch (error) {
                updateTestStatus(1, 'error', '✗ Erro', 'Erro: ' + error.message);
            }
        }
        
        // Teste 2: Estrutura do Banco
        async function testDatabaseStructure() {
            try {
                const response = await fetch('php/get_aluno.php');
                if (response.ok) {
                    updateTestStatus(2, 'success', '✓ Sucesso', 'Tabelas do banco estão funcionando');
                } else {
                    updateTestStatus(2, 'warning', '⚠ Aviso', 'Banco pode não estar configurado corretamente');
                }
            } catch (error) {
                updateTestStatus(2, 'error', '✗ Erro', 'Erro: ' + error.message);
            }
        }
        
        // Teste 3: Arquivos PHP
        async function testPHPFiles() {
            const phpFiles = [
                'php/login_aluno.php',
                'php/login_professor.php',
                'php/cadastro_aluno.php',
                'php/cadastro_professor.php',
                'php/aula.php',
                'php/checkin.php'
            ];
            
            let successCount = 0;
            
            for (const file of phpFiles) {
                try {
                    const response = await fetch(file);
                    if (response.ok) {
                        successCount++;
                    }
                } catch (error) {
                    console.log(`Erro ao testar ${file}:`, error);
                }
            }
            
            if (successCount === phpFiles.length) {
                updateTestStatus(3, 'success', '✓ Sucesso', `Todos os ${phpFiles.length} arquivos PHP estão acessíveis`);
            } else {
                updateTestStatus(3, 'warning', '⚠ Aviso', `${successCount}/${phpFiles.length} arquivos PHP acessíveis`);
            }
        }
        
        // Teste 4: CSS e JavaScript
        function testFrontendResources() {
            const cssFiles = ['css/theme.css'];
            const jsFiles = ['js/aluno.js', 'js/professor.js'];
            
            let cssLoaded = 0;
            let jsLoaded = 0;
            
            // Verificar CSS
            for (const file of cssFiles) {
                const link = document.querySelector(`link[href="${file}"]`);
                if (link) {
                    cssLoaded++;
                }
            }
            
            // Verificar JS
            for (const file of jsFiles) {
                const script = document.querySelector(`script[src="${file}"]`);
                if (script) {
                    jsLoaded++;
                }
            }
            
            if (cssLoaded === cssFiles.length && jsLoaded === jsFiles.length) {
                updateTestStatus(4, 'success', '✓ Sucesso', 'Todos os recursos frontend estão carregados');
            } else {
                updateTestStatus(4, 'warning', '⚠ Aviso', `CSS: ${cssLoaded}/${cssFiles.length}, JS: ${jsLoaded}/${jsFiles.length}`);
            }
        }
        
        // Teste 5: Responsividade
        function testResponsiveness() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            
            if (width < 768) {
                updateTestStatus(5, 'success', '✓ Sucesso', `Mobile detectado (${width}x${height}) - Design responsivo ativo`);
            } else if (width < 1024) {
                updateTestStatus(5, 'success', '✓ Sucesso', `Tablet detectado (${width}x${height}) - Design responsivo ativo`);
            } else {
                updateTestStatus(5, 'success', '✓ Sucesso', `Desktop detectado (${width}x${height}) - Design responsivo ativo`);
            }
        }
        
        // Executar todos os testes
        async function runAllTests() {
            updateTestStatus(1, 'warning', '⏳ Testando...', 'Iniciando teste de conexão...');
            await testDatabaseConnection();
            
            setTimeout(async () => {
                updateTestStatus(2, 'warning', '⏳ Testando...', 'Iniciando teste de estrutura...');
                await testDatabaseStructure();
            }, 1000);
            
            setTimeout(async () => {
                updateTestStatus(3, 'warning', '⏳ Testando...', 'Iniciando teste de arquivos PHP...');
                await testPHPFiles();
            }, 2000);
            
            setTimeout(() => {
                updateTestStatus(4, 'warning', '⏳ Testando...', 'Iniciando teste de recursos frontend...');
                testFrontendResources();
            }, 3000);
            
            setTimeout(() => {
                updateTestStatus(5, 'warning', '⏳ Testando...', 'Iniciando teste de responsividade...');
                testResponsiveness();
            }, 4000);
        }
        
        // Executar testes automaticamente ao carregar
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(runAllTests, 1000);
        });
    </script>
</body>
</html>
